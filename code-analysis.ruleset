<?xml version="1.0" encoding="utf-8"?>
<RuleSet Name="LoccarAuth Code Analysis Rules" Description="Code analysis rules for LoccarAuth project." ToolsVersion="17.0">
  <IncludeAll Action="Warning" />
  
  <!-- Microsoft.CodeAnalysis.CSharp rules -->
  <Rules AnalyzerId="Microsoft.CodeAnalysis.CSharp" RuleNamespace="Microsoft.CodeAnalysis.CSharp">
    <Rule Id="CS1591" Action="None" /> <!-- Missing XML comment for publicly visible type or member -->
    <Rule Id="CS8618" Action="Warning" /> <!-- Non-nullable field must contain a non-null value when exiting constructor -->
    <Rule Id="CS8625" Action="Warning" /> <!-- Cannot convert null literal to non-nullable reference type -->
  </Rules>

  <!-- StyleCop.Analyzers rules -->
  <Rules AnalyzerId="StyleCop.Analyzers" RuleNamespace="StyleCop.Analyzers">
    <!-- Documentation rules -->
    <Rule Id="SA1633" Action="None" /> <!-- File should have header -->
    <Rule Id="SA1652" Action="None" /> <!-- Enable XML documentation output -->
    <Rule Id="SA1600" Action="None" /> <!-- Elements should be documented -->
    <Rule Id="SA1601" Action="None" /> <!-- Partial elements should be documented -->
    
    <!-- Layout rules -->
    <Rule Id="SA1200" Action="None" /> <!-- Using directives should be placed correctly -->
    <Rule Id="SA1210" Action="Warning" /> <!-- Using directives should be ordered alphabetically by namespace -->
    
    <!-- Naming rules -->
    <Rule Id="SA1309" Action="None" /> <!-- Field names should not begin with underscore -->
    <Rule Id="SA1311" Action="None" /> <!-- Static readonly fields should begin with upper-case letter -->
    
    <!-- Readability rules -->
    <Rule Id="SA1101" Action="None" /> <!-- Prefix local calls with this -->
    <Rule Id="SA1413" Action="Warning" /> <!-- Use trailing comma in multi-line initializers -->
  </Rules>

  <!-- SonarAnalyzer.CSharp rules -->
  <Rules AnalyzerId="SonarAnalyzer.CSharp" RuleNamespace="SonarAnalyzer.CSharp">
    <!-- Critical issues -->
    <Rule Id="S2583" Action="Error" /> <!-- Conditionally executed code should be reachable -->
    <Rule Id="S1145" Action="Error" /> <!-- "if" statement conditions should not unconditionally evaluate to "true" or to "false" -->
    <Rule Id="S1764" Action="Error" /> <!-- Identical expressions should not be used on both sides of a binary operator -->
    
    <!-- Major issues -->
    <Rule Id="S1066" Action="Warning" /> <!-- Collapsible "if" statements should be merged -->
    <Rule Id="S1075" Action="Warning" /> <!-- URIs should not be hardcoded -->
    <Rule Id="S1118" Action="Warning" /> <!-- Utility classes should not have public constructors -->
    <Rule Id="S1172" Action="Warning" /> <!-- Unused method parameters should be removed -->
    <Rule Id="S1481" Action="Warning" /> <!-- Unused local variables should be removed -->
    
    <!-- Security hotspots -->
    <Rule Id="S2245" Action="Warning" /> <!-- Using pseudorandom number generators (PRNGs) is security-sensitive -->
    <Rule Id="S4507" Action="Warning" /> <!-- Delivering code in production with debug features activated is security-sensitive -->
    <Rule Id="S5766" Action="Warning" /> <!-- Deserializing objects is security-sensitive -->
  </Rules>

  <!-- .NET Analyzers -->
  <Rules AnalyzerId="Microsoft.CodeAnalysis.NetAnalyzers" RuleNamespace="Microsoft.CodeAnalysis.NetAnalyzers">
    <!-- Design rules -->
    <Rule Id="CA1031" Action="Warning" /> <!-- Do not catch general exception types -->
    <Rule Id="CA1062" Action="Warning" /> <!-- Validate arguments of public methods -->
    <Rule Id="CA1304" Action="Warning" /> <!-- Specify CultureInfo -->
    <Rule Id="CA1305" Action="Warning" /> <!-- Specify IFormatProvider -->
    <Rule Id="CA1822" Action="Warning" /> <!-- Mark members as static -->
    
    <!-- Security rules -->
    <Rule Id="CA2100" Action="Error" /> <!-- Review SQL queries for security vulnerabilities -->
    <Rule Id="CA3075" Action="Error" /> <!-- Insecure DTD processing in XML -->
    <Rule Id="CA5350" Action="Error" /> <!-- Do Not Use Weak Cryptographic Algorithms -->
    <Rule Id="CA5351" Action="Error" /> <!-- Do Not Use Broken Cryptographic Algorithms -->
    
    <!-- Performance rules -->
    <Rule Id="CA1802" Action="Warning" /> <!-- Use literals where appropriate -->
    <Rule Id="CA1805" Action="Warning" /> <!-- Do not initialize unnecessarily -->
    <Rule Id="CA1810" Action="Warning" /> <!-- Initialize reference type static fields inline -->
    <Rule Id="CA1821" Action="Warning" /> <!-- Remove empty Finalizers -->
    <Rule Id="CA1823" Action="Warning" /> <!-- Avoid unused private fields -->
    <Rule Id="CA1824" Action="Warning" /> <!-- Mark assemblies with NeutralResourcesLanguageAttribute -->
    <Rule Id="CA1825" Action="Warning" /> <!-- Avoid zero-length array allocations -->
    
    <!-- Reliability rules -->
    <Rule Id="CA2000" Action="Warning" /> <!-- Dispose objects before losing scope -->
    <Rule Id="CA2002" Action="Warning" /> <!-- Do not lock on objects with weak identity -->
    <Rule Id="CA2007" Action="None" /> <!-- Consider calling ConfigureAwait on the awaited task -->
    <Rule Id="CA2009" Action="Warning" /> <!-- Do not call ToImmutableCollection on an ImmutableCollection value -->
  </Rules>
</RuleSet>
